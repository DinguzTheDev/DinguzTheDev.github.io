<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>PROJECT: BIRTHDAY | MGMT</title>
    <link href="https://fonts.googleapis.com/css2?family=Rajdhani:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>

    <style>
        :root {
            --bg-main: #020810;
            --bg-panel: rgba(13, 25, 41, 0.85);
            --accent: #00d2ff;
            --accent-glow: rgba(0, 210, 255, 0.4);
            --success: #00ff9d;
            --success-glow: rgba(0, 255, 157, 0.3);
            --danger: #ff0055;
            --text-main: #f0f9ff;
            --text-dim: #708ea0;
            --glass-border: 1px solid rgba(255, 255, 255, 0.1);
        }

        * { box-sizing: border-box; user-select: none; -webkit-tap-highlight-color: transparent; margin: 0; padding: 0; }

        body {
            background: radial-gradient(circle at top center, #0a1f38 0%, var(--bg-main) 70%);
            color: var(--text-main);
            font-family: 'Rajdhani', sans-serif;
            min-height: 100vh;
            display: flex; flex-direction: column; align-items: center;
        }

        /* --- FANCY BUTTONS --- */
        .btn-glow {
            background: linear-gradient(135deg, var(--accent), #00a2ff);
            color: #000; border: none; padding: 12px 24px;
            font-weight: 700; text-transform: uppercase; border-radius: 6px;
            cursor: pointer; transition: all 0.3s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            box-shadow: 0 4px 15px var(--accent-glow); letter-spacing: 1px;
        }
        .btn-glow:hover { transform: translateY(-3px); box-shadow: 0 8px 25px var(--accent-glow); filter: brightness(1.1); }
        .btn-success { background: linear-gradient(135deg, var(--success), #00cc7d); box-shadow: 0 4px 15px var(--success-glow); }

        /* --- HEADER (NO TOP SPACING) --- */
        header {
            width: 100%; padding: 10px 5%;
            background: rgba(2, 8, 16, 0.9); backdrop-filter: blur(15px);
            display: flex; justify-content: space-between; align-items: center;
            border-bottom: var(--glass-border); position: sticky; top: 0; z-index: 1000;
        }
        .balance-display { background: rgba(0, 210, 255, 0.1); border: 1px solid var(--accent); padding: 5px 15px; border-radius: 50px; font-weight: 700; color: var(--accent); }

        /* --- MAIN CONTENT --- */
        .main-wrapper { display: flex; width: 100%; max-width: 1400px; padding: 15px 20px; gap: 20px; }

        #cart-sidebar {
            width: 350px; background: var(--bg-panel); backdrop-filter: blur(10px);
            border: var(--glass-border); border-radius: 12px; padding: 20px;
            display: flex; flex-direction: column; position: sticky; top: 80px;
            height: calc(100vh - 100px); box-shadow: 0 10px 30px rgba(0,0,0,0.5);
        }
        .cart-title { font-size: 1.5rem; font-weight: 700; color: white; margin-bottom: 15px; text-align: center; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 10px;}
        #cart-items-list { flex-grow: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 10px; }
        .cart-item { background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.05); padding: 10px; border-radius: 6px; display: flex; justify-content: space-between; align-items: center; }
        .remove-btn { color: var(--danger); cursor: pointer; font-weight: bold; padding: 0 5px; }

        #shop-phase-container { display: none; width: 100%; flex-direction: column; }
        .gift-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(240px, 1fr)); gap: 20px; }
        .gift-card { background: var(--bg-panel); border: var(--glass-border); border-radius: 10px; overflow: hidden; display: flex; flex-direction: column; transition: 0.3s; }
        .gift-card:hover { transform: translateY(-5px); border-color: var(--accent); }
        .gift-img-box { width: 100%; height: 160px; background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; padding: 10px; }
        .gift-img { max-width: 100%; max-height: 100%; object-fit: contain; }
        .gift-info { padding: 15px; display: flex; flex-direction: column; gap: 10px; flex-grow: 1; }
        .gift-title { font-size: 1.1rem; font-weight: 600; color: white; min-height: 2.8rem; }

        /* --- GAME PANEL --- */
        .game-panel { background: var(--bg-panel); backdrop-filter: blur(10px); width: 100%; max-width: 800px; padding: 30px; border-radius: 15px; border: var(--glass-border); }
        .nav-games { display: flex; gap: 10px; margin-bottom: 20px; justify-content: center; }
        .game-tab { background: rgba(255,255,255,0.05); padding: 10px 20px; border-radius: 6px; cursor: pointer; color: var(--text-dim); font-weight: 600; font-size: 0.9rem; }
        .game-tab.active { background: rgba(0, 210, 255, 0.1); border: 1px solid var(--accent); color: white; }

        /* --- OVERLAYS --- */
        #lockdown-overlay { position: fixed; inset: 0; background: #000; z-index: 9999; display: flex; flex-direction: column; align-items: center; justify-content: center; }
        .countdown-big { font-size: 5rem; font-weight: 800; color: var(--accent); text-shadow: 0 0 30px var(--accent-glow); }

        #notify { position: fixed; top: 20px; left: 50%; transform: translateX(-50%); z-index: 10000; padding: 12px 25px; border-radius: 6px; font-weight: 700; display: none; box-shadow: 0 5px 15px rgba(0,0,0,0.5); }
        
        @media (max-width: 900px) { .main-wrapper { flex-direction: column; } #cart-sidebar { width: 100%; height: auto; position: relative; top: 0; } }
    </style>
</head>
<body>

<div id="wipe-screen" style="position:fixed; inset:0; background:black; z-index:100000; display:none; flex-direction:column; align-items:center; justify-content:center; color:red;">
    <h1>TERMINATED</h1>
</div>

<div id="lockdown-overlay">
    <div style="letter-spacing: 5px; color: #444; margin-bottom: 10px;">ENCRYPTED SESSION</div>
    <div class="countdown-big" id="lock-timer">00:00:00:00</div>
</div>

<div id="notify"></div>
<canvas id="confetti-canvas" style="position:fixed; inset:0; pointer-events:none; z-index:9998;"></canvas>

<header id="main-header" style="display:none;">
    <div style="font-weight: 800; font-size: 1.2rem;">PROJECT:<span style="color:var(--accent)">BIRTHDAY</span></div>
    <div style="display:flex; align-items:center; gap:20px;">
        <div id="game-timer-display" style="color:var(--danger); font-weight:700; font-family: monospace;">01:00</div>
        <div class="balance-display"><span id="balance">0</span> MC</div>
    </div>
</header>

<div class="main-wrapper">
    <div id="game-phase-container" style="display:none; width:100%; flex-direction:column; align-items:center;">
        <div class="nav-games">
            <div class="game-tab active" onclick="switchGame('crash', this)">CRASH</div>
            <div class="game-tab" onclick="switchGame('mines', this)">MINES</div>
        </div>
        <div class="game-panel">
            <div style="display:flex; gap:15px; margin-bottom:20px;">
                <div style="flex:1">
                    <label style="font-size:0.7rem; color:var(--text-dim); margin-bottom:5px; display:block;">STAWKA</label>
                    <input type="number" id="bet-amount" value="100" style="width:100%; background:rgba(0,0,0,0.5); border:1px solid #1e3a52; color:white; padding:10px; border-radius:4px;">
                </div>
                <div id="extra-controls" style="flex:1"></div>
            </div>
            <div id="game-area" style="min-height:220px; display:flex; justify-content:center; align-items:center;"></div>
            <div id="game-actions" style="display:flex; gap:10px; margin-top:20px;"></div>
        </div>
    </div>

    <div id="shop-phase-container">
        <div style="text-align:center; margin-bottom:25px;">
            <h2 style="font-size:1.8rem;">MARKETPLACE</h2>
            <p style="color:var(--text-dim); font-size:0.9rem;">Wybierz prezenty. Masz ograniczony bud偶et.</p>
        </div>
        <div class="gift-grid" id="gift-grid"></div>
    </div>

    <div id="cart-sidebar" style="display:none;">
        <div class="cart-title">KOSZYK</div>
        <div id="cart-items-list"></div>
        <button class="btn-glow btn-success" style="width:100%; margin-top:20px; padding:15px;" onclick="finalizeOrder()">ZAMW PREZENTY</button>
    </div>
</div>

<div id="final-screen" style="display:none; text-align:center; width:100%; padding-top:100px;">
    <h1 style="color:var(--success); font-size:4rem; text-shadow: 0 0 20px var(--success-glow);">SUKCES!</h1>
    <p>Zam贸wienie zostao przekazane.</p>
</div>

<div id="admin-login-modal" style="display:none; position:fixed; inset:0; background:rgba(0,0,0,0.95); z-index:10000; align-items:center; justify-content:center;">
    <div style="background:#051421; padding:30px; border-radius:10px; border:1px solid var(--accent); width:300px;">
        <h3>ADMIN ACCESS</h3>
        <input type="password" id="admin-pass" style="width:100%; padding:10px; margin:15px 0; background:#000; border:1px solid #333; color:white;">
        <button class="btn-glow" style="width:100%" onclick="checkAdmin()">LOGIN</button>
    </div>
</div>

<footer onclick="triggerAdmin()" style="margin-top:auto; padding:20px; color:#223e57; font-size:0.7rem; text-align:center;">
    SECURE CONNECTION 2026 | NODE: <span id="my-user-id"></span>
</footer>

<script>
    // --- FIREBASE ---
    const firebaseConfig = {
        apiKey: "AIzaSyDJDQU7KDdUfhir0zU3qDZw9o7G8ZMjkYM",
        authDomain: "dinguzcasino.firebaseapp.com",
        databaseURL: "https://dinguzcasino-default-rtdb.europe-west1.firebasedatabase.app",
        projectId: "dinguzcasino",
        storageBucket: "dinguzcasino.firebasestorage.app",
        messagingSenderId: "852367818280",
        appId: "1:852367818280:web:d028016fe2b75ae63f7f1d"
    };
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();
    const WEBHOOK_URL = "https://discord.com/api/webhooks/1452455171723366533/AXVryGu8apz0R-Gr8jBP3EOCiPweO87OuLlo6qUkmqVipABBHfIwCd7mKt131JaXbhkR";

    // --- FULL PRODUCTS LIST ---
    const birthdayGifts = [
        { id: 1, name: "Karta Podarunkowa 800 R$", valPLN: 63, desc: "Instant", img: "https://upload.wikimedia.org/wikipedia/commons/thumb/3/3a/Roblox_player_icon_black.svg/1200px-Roblox_player_icon_black.svg.png" },
        { id: 2, name: "Gra Steam do 60Z", valPLN: 60, desc: "Gift/Klucz", img: "https://cdn-icons-png.flaticon.com/512/220/220223.png" },
        { id: 3, name: "Pokrowce IkarVR (Quest 2)", valPLN: 45, desc: "2 dni", img: "https://i.postimg.cc/mD9VXsGM/image-removebg-preview-(57).png" },
        { id: 4, name: "Xbox Game Pass ULTIMATE", valPLN: 62, desc: "Miesic", img: "https://cms-assets.xboxservices.com/assets/d1/3c/d13c81f4-48c4-429e-b630-23bc1a2e913c.svg" },
        { id: 5, name: "Kamerka BLOW HD", valPLN: 70, desc: "2 dni", img: "https://i.ibb.co/Ngfyr4nJ/image-removebg-preview-57.png" },
        { id: 6, name: "Pokrowiec IkarVR (Quest 2)", valPLN: 35, desc: "2 dni", img: "https://i.ibb.co/hF2M2BCZ/image-removebg-preview-58.png" },
        { id: 7, name: "Pokrowiec IkarVR PIKACHU [NIEDOSTEPNY!]", valPLN: 120, desc: "2 dni", img: "https://i.ibb.co/DHXXCQ8P/image-removebg-preview-59.png" },
        { id: 8, name: "Kabel PCVR 5M", valPLN: 100, desc: "Wersja Pro", img: "https://i.ibb.co/27gxWcRX/image-removebg-preview-60.png" },
        { id: 9, name: "Gunstock Quest 2", valPLN: 80, desc: "7 dni", img: "https://i.ibb.co/TBW8GpTF/image-removebg-preview-61.png" },
        { id: 10, name: "Mata MIMIMIMI", valPLN: 20, desc: "7 dni", img: "https://i.ibb.co/6K8wTcB/image.png" },
        { id: 11, name: "Zabawkowy GLOCK", valPLN: 20, desc: "7 dni", img: "https://i.ibb.co/RkmLJCVW/image.png" },
        { id: 12, name: "Obraz Minecraft SKULL", valPLN: 28, desc: "7 dni", img: "https://i.ibb.co/0RvCL2TD/image.png" },
        { id: 13, name: "Case z zapalark", valPLN: 15, desc: "7 dni", img: "https://i.ibb.co/tpSznP5c/image.png" },
        { id: 14, name: "Karty brainrot 10PACK", valPLN: 12, desc: "80 kart", img: "https://i.ibb.co/b5LWtmbG/image-removebg-preview-62.png" },
        { id: 15, name: "Replika BMW M4 CSL", valPLN: 30, desc: "Skala 1:36", img: "https://i.ibb.co/YwmVVZ0/image-removebg-preview-63.png" },
        { id: 16, name: "Sztyft do nosa", valPLN: 4, desc: "7 dni", img: "https://i.ibb.co/JjcMG1xn/image.png" },
        { id: 17, name: "MEGA SIGMA BLOWER", valPLN: 55, desc: "7 dni", img: "https://i.ibb.co/tMwrTRmR/image.png" },
        { id: 18, name: "Figet Toy Blue Switch", valPLN: 4, desc: "7 dni", img: "https://i.ibb.co/rR2pB1tW/image-removebg-preview-64.png" }
    ];

    // --- ENGINE ---
    let balance = 3000, gameStartTime = null, hasPurchased = false, userID = "";
    let cart = [], currentGame = 'crash', gameActive = false;
    const TARGET_DATE = new Date('2026-01-03T00:00:00').getTime(); 
    const GAME_DURATION = 60 * 1000;

    function init() {
        let b = localStorage.getItem('bd_balance');
        balance = (b && b !== "NaN") ? parseInt(b) : 3000;
        gameStartTime = localStorage.getItem('bd_startTime') ? parseInt(localStorage.getItem('bd_startTime')) : null;
        hasPurchased = localStorage.getItem('bd_purchased') === 'true';
        userID = localStorage.getItem('moon_userID') || Math.random().toString(36).substring(2, 7).toUpperCase();
        localStorage.setItem('moon_userID', userID);
        document.getElementById('my-user-id').innerText = userID;
        updateUI();
        setInterval(checkPhase, 1000);
        setupFirebase();
    }

    function checkPhase() {
        const now = Date.now();
        if(now < TARGET_DATE) {
            document.getElementById('lock-timer').innerText = new Date(TARGET_DATE - now).toISOString().substr(11, 8);
            return;
        }
        document.getElementById('lockdown-overlay').style.display = 'none';
        document.getElementById('main-header').style.display = 'flex';
        if(!gameStartTime) { gameStartTime = now; localStorage.setItem('bd_startTime', gameStartTime); }
        if(hasPurchased || (now - gameStartTime > GAME_DURATION)) showShop();
        else showGame(now);
    }

    function showGame(now) {
        document.getElementById('game-phase-container').style.display = 'flex';
        document.getElementById('shop-phase-container').style.display = 'none';
        let l = Math.max(0, GAME_DURATION - (now - gameStartTime));
        document.getElementById('game-timer-display').innerText = "00:" + String(Math.floor(l/1000)).padStart(2,'0');
        if(!document.getElementById('game-area').innerHTML) renderGame();
    }

    function showShop() {
        document.getElementById('game-phase-container').style.display = 'none';
        if(hasPurchased) { document.getElementById('shop-phase-container').style.display = 'none'; document.getElementById('cart-sidebar').style.display = 'none'; document.getElementById('final-screen').style.display = 'block'; }
        else { document.getElementById('shop-phase-container').style.display = 'flex'; document.getElementById('cart-sidebar').style.display = 'flex'; if(!document.getElementById('gift-grid').innerHTML) renderMarket(); }
    }

    function renderMarket() {
        const grid = document.getElementById('gift-grid'); grid.innerHTML = '';
        birthdayGifts.forEach(g => {
            grid.innerHTML += `<div class="gift-card"><div class="gift-img-box"><img src="${g.img}" class="gift-img"></div><div class="gift-info"><div class="gift-title">${g.name}</div><button class="btn-glow" onclick="addToCart(${g.id})">WYBIERAM</button></div></div>`;
        });
    }

    function addToCart(id) {
        const item = birthdayGifts.find(x => x.id === id);
        const total = cart.reduce((s, i) => s + i.valPLN, 0);
        if(total + item.valPLN > 100) return notify("Ten przedmiot nie zmieci si ju偶 w limicie!", "error");
        cart.push(item); updateCartUI(); notify("Dodano!", "success");
    }

    function updateCartUI() {
        const l = document.getElementById('cart-items-list'); l.innerHTML = cart.length ? '' : 'Pusto';
        cart.forEach((it, idx) => { l.innerHTML += `<div class="cart-item"><span>${it.name}</span><span class="remove-btn" onclick="removeFromCart(${idx})">&times;</span></div>`; });
    }

    function removeFromCart(idx) { cart.splice(idx, 1); updateCartUI(); }

    function finalizeOrder() {
        if(!cart.length) return;
        if(!confirm("To Tw贸j ostateczny wyb贸r?")) return;
        hasPurchased = true; localStorage.setItem('bd_purchased', 'true');
        fetch(WEBHOOK_URL, {method:'POST', headers:{'Content-Type':'application/json'}, body:JSON.stringify({content:` **NOWE ZAMWIENIE (ID: ${userID}):**\n${cart.map(i=>i.name).join(", ")}`})});
        showShop(); confetti({ particleCount: 150, spread: 70, origin: { y: 0.6 } });
    }

    // --- GAMES ---
    function switchGame(g, el) { currentGame = g; document.querySelectorAll('.game-tab').forEach(t=>t.classList.remove('active')); el.classList.add('active'); renderGame(); }
    function renderGame() {
        const a = document.getElementById('game-area'), s = document.getElementById('game-actions'); a.innerHTML = ''; s.innerHTML = '';
        if(currentGame === 'crash') { a.innerHTML = '<div id="crash-m" style="font-size:4rem; font-weight:800">1.00x</div>'; s.innerHTML = '<button class="btn-glow" onclick="playCrash()">START</button>'; }
        else { a.innerHTML = '<div id="mines-grid" style="display:grid; grid-template-columns:repeat(5,1fr); gap:8px;"></div>'; s.innerHTML = '<button class="btn-glow" onclick="playMines()">START</button>'; initMinesGrid(); }
    }

    function initMinesGrid() { const g = document.getElementById('mines-grid'); for(let i=0;i<25;i++) g.innerHTML += '<div style="width:45px;height:45px;background:rgba(255,255,255,0.05);border-radius:4px;"></div>'; }

    let mm=[], mr=0;
    function playMines() {
        const b = parseInt(document.getElementById('bet-amount').value); if(b > balance) return notify("Brak rodk贸w", "error");
        updateBalance(-b); gameActive = true; mr = 0; mm = Array(25).fill(0);
        for(let i=0; i<3; i++) mm[Math.floor(Math.random()*25)] = 1;
        const g = document.getElementById('mines-grid'); g.innerHTML = '';
        for(let i=0; i<25; i++) {
            let d = document.createElement('div'); d.style = "width:45px;height:45px;background:#162a42;cursor:pointer;display:flex;align-items:center;justify-content:center;border-radius:4px;font-size:1.2rem;";
            d.onclick = () => {
                if(!gameActive || d.innerText) return;
                if(mm[i]) { d.innerText = ''; d.style.background = '#ff0055'; gameActive = false; document.getElementById('game-actions').innerHTML = '<button class="btn-glow" onclick="renderGame()">RETRY</button>'; }
                else { d.innerText = ''; d.style.background = '#00ff9d'; d.style.color = '#000'; mr++; }
            };
            g.appendChild(d);
        }
        document.getElementById('game-actions').innerHTML = '<button class="btn-glow btn-success" onclick="minesCashout()">WYPA</button>';
    }

    function minesCashout() {
        if(!gameActive) return;
        let m = 1; for(let k=0;k<mr;k++) m *= (25-k)/(22-k);
        updateBalance(Math.floor(parseInt(document.getElementById('bet-amount').value) * m * 1.5));
        gameActive = false; notify("Wypacono!", "success"); renderGame();
    }

    function updateBalance(a){ balance += a; updateUI(); localStorage.setItem('bd_balance', balance); }
    function updateUI(){ document.getElementById('balance').innerText = balance.toLocaleString(); }
    function notify(m,t){ const n=document.getElementById('notify'); n.innerText=m; n.style.display='block'; n.style.background=t==='success'?'#00ff9d':'#fff'; n.style.color='#000'; setTimeout(()=>n.style.display='none',2000); }
    
    let ac=0; function triggerAdmin(){ ac++; if(ac>=5){ document.getElementById('admin-login-modal').style.display='flex'; ac=0; } }
    function checkAdmin(){ if(document.getElementById('admin-pass').value==='mambachuj12') alert("Admin OK - Wipe command active in console."); }
    function setupFirebase() { db.ref('system/wipe').on('child_added', s => { if(s.val().target === userID) { balance=0; updateUI(); document.getElementById('wipe-screen').style.display='flex'; } }); }

    init();
</script>
</body>
</html>
